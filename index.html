<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>UGPhone Stock</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
html, body {
  margin:0; padding:0; height:100%; font-family: Arial, sans-serif; background:#000; color:#eee; overflow-x:hidden;
}

/* Video n·ªÅn */
#video-bg {
  position: fixed; inset:0; width:100%; height:100%; object-fit:cover; z-index:-1;
  filter: blur(4px) brightness(0.6);
}

/* N·ªôi dung */
.content { position:relative; z-index:1; text-align:center; padding:40px 20px; color:#fff; }
.content h1 { font-size:48px; font-weight:900; text-shadow:2px 2px 10px rgba(0,0,0,0.8); margin-bottom:10px; color:#ff0; }
.note { font-size:14px; color:#ff0000; font-weight:bold; margin-bottom:12px; }

/* B·∫£ng stock */
table { width:90%; max-width:700px; margin:20px auto; border-collapse:collapse; background: rgba(0,0,0,0.6); border-radius:12px; font-size:1.2em; }
th, td { padding:15px; text-align:center; border-bottom:1px solid #333; transition: background 0.5s; }
th { background:#d20000; color:#ff0; }
td.server { color:#ff0; font-weight:bold; }
td.status.green { color:#0f0; font-weight:bold; }
td.status.red { color:#f00; font-weight:bold; }
td.status.gray { color:#ccc; font-weight:bold; }
tr:nth-child(even) { background: rgba(0,0,0,0.4); }
tr:hover { background: rgba(255,255,0,0.2); }

/* Animation khi stock thay ƒë·ªïi */
@keyframes highlight {
  0% { background-color: rgba(255,255,0,0.8); }
  50% { background-color: rgba(255,255,0,0.2); }
  100% { background-color: rgba(255,255,0,0.8); }
}
.changed { animation: highlight 1s ease-in-out; }

/* N√∫t b·∫≠t/t·∫Øt ti·∫øng */
.sound-btn {
  position: fixed; bottom:20px; right:20px; z-index:2;
  padding:10px 20px; background: rgba(0,0,0,0.6); color:white; border:none;
  border-radius:8px; cursor:pointer; font-size:16px; transition:background 0.2s;
}
.sound-btn:hover { background: rgba(0,0,0,0.8); }

/* Responsive */
@media(max-width:640px){
  .content h1{ font-size:34px; }
  table{ font-size:1em; }
  .sound-btn{ font-size:14px; padding:8px 16px; }
}
</style>
</head>
<body>

<!-- Video n·ªÅn MP4 -->
<video autoplay muted loop id="video-bg">
  <source src="video.mp4" type="video/mp4">
</video>

<!-- N·ªôi dung -->
<div class="content">
  <h1>üìä UGPhone Stock</h1>
  <p class="note">C·∫≠p nh·∫≠t theo API UgPhone</p>

  <table id="stock-table">
    <thead>
      <tr>
        <th>Server</th>
        <th>Tr·∫°ng th√°i</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <button class="sound-btn" onclick="toggleSound()">üîä B·∫≠t ti·∫øng</button>
</div>

<script>
const video = document.getElementById("video-bg");
let isMuted = true;

function toggleSound() {
  video.muted = !video.muted;
  document.querySelector(".sound-btn").innerText = video.muted ? "üîä B·∫≠t ti·∫øng" : "üîá T·∫Øt ti·∫øng";
}

// L∆∞u tr·∫°ng th√°i c≈© ƒë·ªÉ so s√°nh
let oldStatuses = {};

async function loadStock() {
  try {
    const res = await fetch('https://meows.io.vn/call-ugphone-status');
    const data = await res.json();
    const tbody = document.querySelector('#stock-table tbody');
    tbody.innerHTML = '';

    if (data.success && Array.isArray(data.status)) {
      data.status.forEach(line => {
        if(line.includes('Uptime') || line.includes('Trang th√°i')) return;
        const parts = line.split(':');
        if(parts.length<2) return;

        const serverName = parts[0].trim();
        const statusEmoji = parts[1].trim();
        let statusText='', statusClass='gray';

        if(statusEmoji.includes('üü¢')) { statusText='üü¢ C√≤n m√°y'; statusClass='green'; }
        else if(statusEmoji.includes('üî¥')) { statusText='üî¥ H·∫øt m√°y'; statusClass='red'; }

        const tr = document.createElement('tr');
        const tdServer = document.createElement('td');
        tdServer.textContent = serverName;
        tdServer.className='server';
        const tdStatus = document.createElement('td');
        tdStatus.textContent=statusText;
        tdStatus.className='status '+statusClass;

        // Animation highlight khi thay ƒë·ªïi
        if(oldStatuses[serverName] && oldStatuses[serverName] !== statusText){
          tdStatus.classList.add('changed');
          setTimeout(()=> tdStatus.classList.remove('changed'),1000);
        }
        oldStatuses[serverName] = statusText;

        tr.appendChild(tdServer);
        tr.appendChild(tdStatus);
        tbody.appendChild(tr);
      });
    }
  } catch(err){ console.error('Kh√¥ng th·ªÉ load stock',err); }
}

loadStock();
setInterval(loadStock,1000);
</script>
</body>
</html>
